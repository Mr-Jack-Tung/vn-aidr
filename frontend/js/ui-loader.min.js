/*!
 * Open AI Doctor v0.0.1 (https://github.com/vietanhdev/ai-doctor)
 * Copyright 2020-2021 Viet Anh Nguyen
 * Licensed under MIT (https://github.com/StartBootstrap/open-ai-doctor/blob/master/LICENSE)
 */

$(function(){"use strict";var o;function s(){$(".loading-modal").hide()}$.get("ui-config.json",function(e){window.UI={};var i=window.UI;document.title=e.title,$(".sidebar-brand-text").html(e["sidebar-brand-text"]),$(".sidebar-brand-icon img").attr("src",e.logo);let n="";var t=e.sections;i.sections=t;for(let e=0;e<t.length;++e)n+='<li name="'+t[e].id+'" class="nav-item"><a class="nav-link" href="#"><i class="fas '+t[e].icon+'"></i><span>'+t[e].title+"</span></a></li>";$("#section-menu").html(n),$("#section-menu li").each(function(){$(this).click(function(){!function(i){$("#section-menu li").removeClass("active");for(let e=0;e<window.UI.sections.length;++e){var n=window.UI.sections[e];if(n.id==i){console.log("Select: "+i),$("#section-title").html(n.title),$('#section-menu li[name="'+i+'"]').addClass("active"),$("#display-image").attr("src",n.img_placeholder),$("#display-image").hide(),$("#output-log").val(""),window.UI.api_endpoint=n.api_endpoint,o.update(),o.moveTo(0,0);break}}}($(this).attr("name"))})}),$("#section-menu li").first().click()}),(o=new Viewer(document.getElementById("display-image"),{inline:!0,navbar:!1,title:!1})).show(),$("#upload-btn").click(function(){$("#upload-file").click()}),$("#upload-file").change(function(){$(".loading-modal").show();var e=new FormData,i=$(this)[0].files;0<i.length?(e.append("file",i[0]),console.log("Sending request to: "+window.UI.api_endpoint),$.ajax({url:window.UI.api_endpoint,type:"post",data:e,contentType:!1,processData:!1,success:function(e){e.success?($("#display-image").attr("src",e.image),o.update(),o.moveTo(0,0)):alert("Error on processing! Please try again."),s();let i=[],n=[],t=e.proba;for(var a in t)t.hasOwnProperty(a)&&(i.push(a+": "+t[a].toFixed(2)),n.push(t[a]));i=i.sort(function(e,i){return n.indexOf(e)-n.indexOf(i)}).reverse(),$("#output-log").val(i.join("\n"))},error:function(){s()}}),$(this).val("")):alert("Please select a file.")})});